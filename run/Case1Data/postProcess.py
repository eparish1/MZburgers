from pylab import *
axis_font = {'size':'24'}
close("all")
DNS = load('DNSstats.npz')
ILES = load('ILESstats.npz')
tmodel = load('tmodelstats.npz')
FM1 = load('FM1stats.npz')
#FM1 = load('../FM1/Solution/stats.npz')
FM2 = load('FM2stats.npz')
FM3 = load('FM3stats.npz')
Smag = load('Smagstats.npz')

#CM3 = load('CM3stats.npz')

DNSscale =  sqrt( 1./ size(DNS['u'][:,0])  )
LESscale =  sqrt( 1./ size(tmodel['u'][:,0])  )
figure(1)
kc = int( amax(tmodel['k']))
plot(DNS['t'],mean(abs(DNS['tauhat'][0:kc,:])*DNSscale,axis=0),'s',mfc='none',label='DNS') 
plot(Smag['t'],mean(abs(Smag['tauhat'][0:kc,:])*LESscale,axis=0),color='blue',lw=2,label='SS')
plot(tmodel['t'],mean(abs(tmodel['tauhat'][0:kc,:])*LESscale,axis=0),lw=2,label='t-model')
plot(FM1['t'],mean(abs(FM1['tauhat'][0:kc,:])*LESscale,axis=0),lw=2,label='FM1')
plot(FM2['t'],mean(abs(FM2['tauhat'][0:kc,:])*LESscale,axis=0),lw=2,label='FM2')
plot(FM3['t'],mean(abs(FM3['tauhat'][0:kc,:])*LESscale,axis=0),lw=2,label='FM3')

xlabel(r'$t$',**axis_font)
ylabel('Mean SGS Magnitude',**axis_font)
legend(loc=1,numpoints=1)
savefig('Case1_MeanSGS.png')

figure(2)
plot(DNS['tf'][0::20],   DNS['Energy_resolved'][0::20]*DNSscale**2,'s',mfc='none',label='DNS') 
plot(Smag['tf'],Smag['Energy']*LESscale**2,color='blue',lw=2,label='SS')
plot(ILES['tf'], ILES['Energy_resolved']*LESscale**2,lw=2,label='NO SGS') 
plot(tmodel['tf'],tmodel['Energy']*LESscale**2,lw=2,label='t-model')
plot(FM1['tf'],FM1['Energy']*LESscale**2,lw=2,label='FM1')
plot(FM2['tf'],FM2['Energy']*LESscale**2,lw=2,label='FM2')
plot(FM3['tf'],FM3['Energy']*LESscale**2,lw=2,label='FM3')
#plot(CM3['tf'],   CM3['Energy']*LESscale**2,label='CM3')
xlabel(r'$t$',**axis_font)
ylabel(r'Energy',**axis_font)
legend(loc=1,numpoints=1)
savefig('Case1_Energy.png')

figure(3)
plot(DNS['tf'][0::20],-DNS['Dissipation_resolved'][0::20]*DNSscale**2,'s',mfc='none',label='DNS') 
plot(ILES['tf'],-ILES['Dissipation_resolved']*LESscale**2,lw=2,label='NO SGS') 
plot(Smag['tf'],-Smag['Dissipation_resolved']*LESscale**2,color='blue',lw=2,label='SS')
plot(tmodel['tf'],-tmodel['Dissipation']*LESscale**2,lw=2,label='tmodel')
plot(FM1['tf'],-FM1['Dissipation']*LESscale**2,lw=2,label='FM1')
plot(FM2['tf'],-FM2['Dissipation']*LESscale**2,lw=2,label='FM2')
plot(FM3['tf'],-FM3['Dissipation_resolved']*LESscale**2,lw=2,label='FM3')
xlabel(r'$t$',**axis_font)
ylabel(r'$-\frac{dE}{dt}$',**axis_font)
legend(loc=1,numpoints=1)
savefig('Case1_Dissipation')

figure(4)
indx = 2
plot(real(DNS['uhat'][indx,0::20])*DNSscale,imag(DNS['uhat'][indx,0::20])*DNSscale,'s',mfc='none',label='DNS') 
plot(real(ILES['uhat'][indx,:])*LESscale,imag(ILES['uhat'][indx,:])*LESscale,lw=2,label='NO SGS') 
plot(real(Smag['uhat'][indx,:])*LESscale,imag(Smag['uhat'][indx,:])*LESscale,color='blue',lw=2,label='SS')
plot(real(tmodel['uhat'][indx,:])*LESscale,imag(tmodel['uhat'][indx,:])*LESscale,lw=2,label='tmodel')
plot(real(FM1['uhat'][indx,:])*LESscale,imag(FM1['uhat'][indx,:])*LESscale,lw=2,label='FM1')
plot(real(FM2['uhat'][indx,:])*LESscale,imag(FM2['uhat'][indx,:])*LESscale,lw=2,label='FM2')
plot(real(FM3['uhat'][indx,:])*LESscale,imag(FM3['uhat'][indx,:])*LESscale,lw=2,label='FM3')
grid()
legend(loc=1,numpoints=1)
xlabel(r'Real($\hat{u}$)',**axis_font)
ylabel(r'Imag($\hat{u}$)',**axis_font)

figure(5)
indx = 8
plot(real(DNS['uhat'][indx,0::20])*DNSscale,imag(DNS['uhat'][indx,0::20])*DNSscale,'s',mfc='none',label='DNS') 
plot(real(ILES['uhat'][indx,:])*LESscale,imag(ILES['uhat'][indx,:])*LESscale,lw=2,label='NO SGS') 
plot(real(Smag['uhat'][indx,:])*LESscale,imag(Smag['uhat'][indx,:])*LESscale,color='blue',lw=2,label='SS')
plot(real(tmodel['uhat'][indx,:])*LESscale,imag(tmodel['uhat'][indx,:])*LESscale,lw=2,label='tmodel')
plot(real(FM1['uhat'][indx,:])*LESscale,imag(FM1['uhat'][indx,:])*LESscale,lw=2,label='FM1')
plot(real(FM2['uhat'][indx,:])*LESscale,imag(FM2['uhat'][indx,:])*LESscale,lw=2,label='FM2')
plot(real(FM3['uhat'][indx,:])*LESscale,imag(FM3['uhat'][indx,:])*LESscale,lw=2,label='FM3')
legend(loc=1,numpoints=1)
xlabel(r'Real($\hat{u}$)',**axis_font)
ylabel(r'Imag($\hat{u}$)',**axis_font)
grid()
savefig('Case1_uphase.png')

figure(6)
indx = 8
plot(real(DNS['tauhat'][indx,0::20])*DNSscale,imag(DNS['tauhat'][indx,0::20])*DNSscale,'s',mfc='none',label='DNS') 
plot(real(Smag['tauhat'][indx,:])*LESscale,imag(Smag['tauhat'][indx,:])*LESscale,color='blue',lw=2,label='SS')
plot(real(tmodel['tauhat'][indx,:])*LESscale,imag(tmodel['tauhat'][indx,:])*LESscale,lw=2,label='tmodel')
plot(real(FM1['tauhat'][indx,:])*LESscale,imag(FM1['tauhat'][indx,:])*LESscale,lw=2,label='FM1')
plot(real(FM2['tauhat'][indx,:])*LESscale,imag(FM2['tauhat'][indx,:])*LESscale,lw=2,label='FM2')
plot(real(FM3['tauhat'][indx,:])*LESscale,imag(FM3['tauhat'][indx,:])*LESscale,lw=2,label='FM3')
legend(loc=1,numpoints=1)
xlabel(r'Real($\hat{\tau}$)',**axis_font)
ylabel(r'Imag($\hat{\tau}$)',**axis_font)
grid()

savefig('Case1_tauphase.png')


figure(7)
tloc = 1.0
DNSind = argmin(tloc - DNS['t'])
LESind = argmin(tloc - tmodel['t'])
plot(DNS['k'],0.5*(DNS['uhat']*conj(DNS['uhat']))[:,DNSind]*DNSscale**2,'s',mfc='none',label='DNS') 
plot(ILES['k'],0.5*(ILES['uhat']*conj(ILES['uhat']))[:,LESind]*LESscale**2,lw=2,label='NO SGS') 
plot(Smag['k'],0.5*(Smag['uhat']*conj(Smag['uhat']))[:,LESind]*LESscale**2,color='blue',lw=2,label='SS')
plot(tmodel['k'],0.5*(tmodel['uhat']*conj(tmodel['uhat']))[:,LESind]*LESscale**2,lw=2,label='tmodel')
plot(FM1['k'],0.5*(FM1['uhat']*conj(FM1['uhat']))[:,LESind]*LESscale**2,lw=2,label='FM1')
plot(FM2['k'],0.5*(FM2['uhat']*conj(FM2['uhat']))[:,LESind]*LESscale**2,lw=2,label='FM2')
plot(FM3['k'],0.5*(FM3['uhat']*conj(FM3['uhat']))[:,LESind]*LESscale**2,lw=2,label='FM3')
xlabel(r'$t$',**axis_font)
ylabel(r'$E(k)$',**axis_font)
xlim([1,15])
ylim([1e-6,1e-2])
xscale('log')
yscale('log')
legend(loc=3,numpoints=1)

figure(8)
plot(FM3['t'],mean(abs(FM3['w0hat'][0:kc,:])*LESscale,axis=0),lw=2,label=r'$\overline{|\hat{w}_0|}$')
plot(FM3['t'],mean(abs(FM3['w1hat'][0:kc,:])*LESscale,axis=0),lw=2,label=r'$\overline{|\hat{w}_1|}$')
plot(FM3['t'],mean(abs(FM3['w2hat'][0:kc,:])*LESscale,axis=0),lw=2,label=r'$\overline{|\hat{w}_2|}$')
xlabel(r'$t$',**axis_font)
ylabel('Mean $\hat{w}$ Magnitude',**axis_font)
legend(loc=1,numpoints=1)
yscale('log')
savefig('Case1_MeanW.png')


figure(9)
indx = 8
plot(real(FM3['w0hat'][indx,:])/amax(abs(real(FM3['w0hat'][indx,:]))),imag(FM3['w0hat'][indx,:])/amax(abs(imag(FM3['w0hat'][indx,:]))),lw=2,label=r'$\hat{w}_0$')
plot(real(FM3['w1hat'][indx,:])/amax(abs(real(FM3['w1hat'][indx,:]))),imag(FM3['w1hat'][indx,:])/amax(abs(imag(FM3['w1hat'][indx,:]))),lw=2,label=r'$\hat{w}_1$')
plot(real(FM3['w2hat'][indx,:])/amax(abs(real(FM3['w2hat'][indx,:]))),imag(FM3['w2hat'][indx,:])/amax(abs(imag(FM3['w2hat'][indx,:]))),lw=2,label=r'$\hat{w}_2$')
plot(real(FM3['w0hat'][indx,0])/amax(abs(real(FM3['w0hat'][indx,0])) + 1e-30),imag(FM3['w0hat'][indx,0])/amax(abs(imag(FM3['w0hat'][indx,0]))+1e-30),'o',color='black')

legend(loc=1,numpoints=1)
xlabel(r'Real($\hat{w}$)',**axis_font)
ylabel(r'Imag($\hat{w}$)',**axis_font)
grid()
savefig('Case1_wphase.png')
show()


